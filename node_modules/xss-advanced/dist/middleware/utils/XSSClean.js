"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var xss_1 = require("xss");
// ES6 class
/**
 * @description Default options are: { css: false, stripIgnoreTagBody: ['script']}
 * @param  {defaultOptions} xssOptions - It accepts any options from https://github.com/leizongmin/js-xss module.
 * @method cleanData - Call cleanData(object) method to clean dirty data from an object
 */
var XSSClean = /** @class */ (function () {
    function XSSClean(xssOptions) {
        var _this = this;
        // Cleans arrays + objects recursively. If it's array SINCE it's for let in it will loop trough the numbers [0] [1] [2], if it's object it will loop trough ['key1'], ['key2']. So in any case it will clean the data.
        this.cleanData = function (object) {
            for (var field in object) {
                // * Recursive way
                if (typeof object[field] === 'object') {
                    //   Object (included array or object) is an refrence type. So every change will be done correctly
                    _this.cleanData(object[field]);
                    continue;
                }
                if (typeof object[field] === 'string') {
                    object[field] = _this.xssInstance.process(object[field]);
                }
            }
        };
        this.xssInstance = new xss_1.FilterXSS(xssOptions);
    }
    return XSSClean;
}());
// module.exports = XSSClean;
// exports = XSSClean;
exports.default = XSSClean;
//# sourceMappingURL=XSSClean.js.map